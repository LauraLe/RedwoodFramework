[{"pk": 20, "model": "expecon.experiment", "fields": {"name": "Discrete Matrix Deploy", "admin_css": "body {\r\n  padding-top: 60px;\r\n}\r\n\r\n", "comments": "", "experimenter": 1, "admin_html": "<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n  <head>\r\n\t\t<title>Discrete Matrix Admin</title>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodAdmin.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n\t<body ng-controller=\"AdminCtrl\">\r\n\t\t<div class=\"navbar navbar-fixed-top container\">\r\n\t\t\t<div class=\"navbar-inner\">\r\n\t\t\t\t<div class=\"container-fluid\">\r\n\t\t\t\t\t<div class=\"brand\" href=\"#\">Economics Experiment</div>\r\n\t\t\t\t\t<div class=\"nav-collapse collapse\">\r\n\t\t\t\t\t\t<p class=\"navbar-text pull-right\">Administrator</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"span3\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"span3\">\r\n\t\t\t\t\t\t\t<div class=\"well sidebar-nav\">\r\n\t\t\t\t\t\t\t\t<ul class=\"nav nav-list\">\r\n\t\t\t\t\t\t\t\t\t<li><span id=\"router-status\" class=\"badge badge-important\"></span></li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"span3\">\r\n\t\t\t\t\t\t\t<div class=\"well sidebar-nav\">\r\n\t\t\t\t\t\t\t\t<ul class=\"nav nav-list\">\r\n\t\t\t\t\t\t\t\t\t<li><a href=\"admin/payouts\" target=\"_blank\">View Payouts</a></li>\r\n\t\t\t\t\t\t\t\t\t<li><a id=\"archive\" href=\"#\">Archive Session</a></li>\r\n\t\t\t\t\t\t\t\t\t<li><a id=\"download\" href=\"admin/download\">Download Data</a></li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"span9\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"span9\">\r\n\t\t\t\t\t\t\t<p>Subjects:</p>\r\n\t\t\t\t\t\t\t<table class=\"table table-bordered table-condensed table-striped\">\r\n\t\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<tr><th>ID</th><th>Group</th><th>Period</th><th style=\"width: 150px;\"></th></tr>\r\n\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t<tbody id=\"subject-list\">\r\n\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"span6\">\r\n\t\t\t\t\t\t\t<button id=\"start-session\" class=\"btn btn-success\">Start Session</button>\r\n\t\t\t\t\t\t\t<button id=\"refresh-subjects\" class=\"btn btn-info\" title=\"Attempt recover by refreshing all subject browsers\">Recover Session</button>\r\n\t\t\t\t\t\t\t<button id=\"reset-session\" class=\"btn btn-danger\">Reset Session</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"span3\">\r\n\t\t\t\t\t\t\t<div class=\"pull-right\">\r\n\t\t\t\t\t\t\t\t<button id=\"pause-session\" class=\"btn btn-warning\" disabled=\"disabled\">Pause</button>\r\n\t\t\t\t\t\t\t\t<button id=\"resume-session\" class=\"btn btn-primary\" disabled=\"disabled\">Resume</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"span12\">\r\n\t\t\t\t\t<hr/>\r\n\t\t\t\t\t<p>Configuration:</p>\r\n\t\t\t\t\t<load-config></load-config>\r\n\t\t\t\t\t<div style=\"overflow: auto;\">\r\n\t\t\t\t\t\t<table class=\"config table table-bordered table-striped table-condensed\"></table>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</body>\r\n</html>\r\n", "admin_js": "Redwood.controller(\"AdminCtrl\", [\"$rootScope\", \"$scope\", \"Admin\", function($rootScope, $scope, ra) {\r\n\tvar Display = { //Display controller\r\n\r\n\t\tinitialize: function() {\r\n\t\t\t$(\"#start-session\").click(function () {\r\n\t\t\t\t$(\"#start-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"start_session\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on(\"start_session\", function() {\r\n\t\t\t\t$(\"#start-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"#pause-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#refresh-subjects\").click(function () {\r\n\t\t\t\t$(\"#refresh-subjects\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.refreshSubjects().then(function() {\r\n\t\t\t\t\t$(\"#refresh-subjects\").removeAttr(\"disabled\");\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#reset-session\").click(function () {\r\n\t\t\t\tra.reset();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pause-session\").click(function () {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"pause\");\r\n\t\t\t});\r\n\t\t\tra.on(\"pause\", function() {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#resume-session\").click(function () {\r\n\t\t\t\t$(\"#resume-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"resume\");\r\n\t\t\t});\r\n\t\t\tra.on(\"resume\", function() {\r\n\t\t\t\t$(\"#resume-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"#pause-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on_subject_paused(function(userId) {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"tr.subject-\" + userId).addClass(\"warning\"); //Display current period for each user\r\n\t\t\t\t$(\"tr.subject-\" + userId + \" :nth-child(4)\").text(\"Paused\"); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_all_paused(function() {\r\n\t\t\t\t$(\"#resume-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on_subject_resumed(function(user) {\r\n\t\t\t\t$(\"tr.subject-\" + user).removeClass(\"warning\"); //Display current period for each user\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(4)\").text(\"\"); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#archive\").click(function () {\r\n\t\t\t\tvar r = confirm(\"Are you sure you want to archive this session?\");\r\n\t\t\t\tif(r == true) {\r\n\t\t\t\t\tra.delete_session();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_router_connected(function(connected) { //Display router connection status\r\n\t\t\t\tvar status = $(\"#router-status\");\r\n\t\t\t\tif (connected) {\r\n\t\t\t\t\tstatus.text(\"Router Connected\");\r\n\t\t\t\t\tstatus.removeClass(\"badge-important\");\r\n\t\t\t\t\tstatus.addClass(\"badge-success\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatus.text(\"Router Disconnected\");\r\n\t\t\t\t\tstatus.removeClass(\"badge-success\");\r\n\t\t\t\t\tstatus.addClass(\"badge-important\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_period(function(user, period) {\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(3)\").text(period); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_group(function(user, group) {\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(2)\").text(group); //Display group for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_register(function(user) { //Add a row to the table to each user\r\n\t\t\t\t$(\"#subject-list\").empty();\r\n\t\t\t\tfor(var i = 0, l = ra.subjects.length; i < l; i++) {\r\n\t\t\t\t\t$(\"#subject-list\").append($(\"<tr>\").addClass(\"subject-\" + ra.subjects[i].user_id).append(\r\n\t\t\t\t\t\t$(\"<td>\").text(ra.subjects[i].user_id).after(\r\n\t\t\t\t\t\t\t$(\"<td>\").text(0).after(\r\n\t\t\t\t\t\t\t\t$(\"<td>\").text(0).after(\r\n\t\t\t\t\t\t\t\t\t$(\"<td>\").text(\"\"))))));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_config(function(config) { //Display the config file\r\n\t\t\t\t$(\"table.config\").empty();\r\n\t\t\t\tvar a = $.csv.toArrays(config);\r\n\t\t\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\t\t\tvar row = a[i];\r\n\t\t\t\t\tvar tr = $(\"<tr>\");\r\n\t\t\t\t\tfor (var j = 0; j < row.length; j++) {\r\n\t\t\t\t\t\tvar cell = row[j];\r\n\t\t\t\t\t\tvar td = $((i == 0 ? \"<th>\" : \"<td>\")).text(cell);\r\n\t\t\t\t\t\ttr.append(td);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(\"table.config\").append(tr);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tvar resetGroups = function() {\r\n\t\tvar config = ra.get_config(1, 0) || {};\r\n\t\tfor (var i = 0; i < ra.subjects.length; i++) { //set all subjects to group 1 (this is so that matching can be changed per period)\r\n\t\t\tif($.isArray(config.groups)) {\r\n\t\t\t\tfor(var groupId = 0; groupId < config.groups.length; groupId++) {\r\n\t\t\t\t\tif($.isArray(config.groups[groupId])) {\r\n\t\t\t\t\t\tif(config.groups[groupId].indexOf(parseInt(ra.subjects[i].user_id)) > -1) { //Nested group array\r\n\t\t\t\t\t\t\tra.set_group(groupId + 1, ra.subjects[i].user_id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tra.set_group(1, ra.subjects[i].user_id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tra.set_group(1, ra.subjects[i].user_id);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tDisplay.initialize();\r\n\r\n\tra.on_load(function () {\r\n\t\tresetGroups(); //Assign groups to users\r\n\t});\r\n\r\n\tra.on_register(function(user) { //Add a row to the table to each user\r\n\t\tresetGroups();\r\n\t});\r\n\r\n\tra.on(\"start_session\", function() {\r\n\t\tra.start_session();\r\n\t});\r\n\r\n\tra.on(\"pause\", function() {\r\n\t\tra.pause();\r\n\t});\r\n\r\n\tra.on(\"resume\", function() {\r\n\t\tra.resume();\r\n\t});\r\n\r\n}]);\r\n\r\n", "rt_js": ""}}, {"pk": 65, "model": "expecon.page", "fields": {"experiment": 20, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n\t<head>\r\n\t\t<title>Wait</title>\r\n\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n{% verbatim %}\r\n\t<body ng-controller=\"SubjectCtrl\">\r\n\t\t\r\n\t\t<div class=\"navbar navbar-fixed-top container\">\r\n\t\t\t<div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t\t\t<li class=\"active\">\r\n\t\t\t\t\t\t<a>User ID: <span>{{ $root.user_id }}</span></a>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\tPlease wait for experiment to start...\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</body>\r\n{% endverbatim %}\r\n</html>\r\n\r\n", "name": "Wait", "css": "body {\r\n  padding-top: 60px;\r\n}\r\n\r\n", "js": "Redwood.controller(\"SubjectCtrl\", [\"$rootScope\", \"$scope\", \"RedwoodSubject\", function($rootScope, $scope, rs) {\r\n\trs.on_load(function() {\r\n\t\trs.next_period();\r\n\t});\r\n}]);\r\n\r\n"}}, {"pk": 66, "model": "expecon.page", "fields": {"experiment": 20, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n<head>\r\n  <title>Start</title>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t<script type=\"text/javascript\">\r\n\t\tvar IMAGE_URL = \"{{ STATIC_URL }}/img/Discrete Matrix\";\r\n\t\t{{ js }}\r\n\t</script>\r\n\t<style type=\"text/css\">\r\n\t\t{{ css }}\r\n\t</style>\r\n</head>\r\n{% verbatim %}\r\n<body style=\"padding-top:80px;\" ng-controller=\"SubjectCtrl\">\r\n\r\n<div class=\"navbar navbar-fixed-top container\">\r\n  <div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t<li class=\"active\">\r\n\t\t\t\t<a>User ID: <span>{{$root.user_id}}</span></a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t\t<div class=\"navbar-right\">\r\n\t\t\t<div class=\"navbar-text\">Period: <span>{{$root.period}}</span></div>\r\n\t\t\t<div class=\"navbar-text\">Round: <span>{{round}} / {{rounds}}</span></div>\r\n\t\t\t<div class=\"navbar-text\">Total Reward: <span>{{$root.totalPoints}}</span></div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<div class=\"container\">\r\n\r\n\t<key-press key-code=\"38\" callback=\"onSelection(1)\"></key-press>\r\n\t<key-press key-code=\"40\" callback=\"onSelection(2)\"></key-press>\r\n\t<key-press key-code=\"13\" callback=\"confirm()\"></key-press>\r\n\r\n\t<div class=\"row\">\r\n\t\t<div class=\"col-lg-2\"></div>\r\n\t\t<div class=\"col-lg-10\">\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-lg-5\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\t\t\t<table id=\"input-matrix\" class=\"table table-bordered table-condensed\">\r\n\t\t\t\t\t\t\t\t<tr style=\"height:40px;\">\r\n\t\t\t\t\t\t\t\t\t<td></td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 1}\">A</td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 2}\">B</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr style=\"height:40px;\">\r\n\t\t\t\t\t\t\t\t\t<td class=\"input-cell\" ng-class=\"{'selected': selection == 1}\">\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"disabled\" ng-hide=\"inputsEnabled\">A</span>\r\n\t\t\t\t\t\t\t\t\t\t<a ng-click=\"onSelection(1)\" ng-show=\"inputsEnabled\" class=\"input-link\" href>A</a>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 1 || selection == 1, 'double-selected': prevPartnerAction == 1 && selection == 1}\">\r\n\t\t\t\t\t\t\t\t\t\t<strong>{{matrix[0][0][0]}}</strong>, <span>{{matrix[0][0][1]}}</span>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 2 || selection == 1, 'double-selected': prevPartnerAction == 2 && selection == 1}\">\r\n\t\t\t\t\t\t\t\t\t\t<strong>{{matrix[0][1][0]}}</strong>, <span>{{matrix[0][1][1]}}</span>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t<tr style=\"height:40px;\">\r\n\t\t\t\t\t\t\t\t\t<td class=\"input-cell\" ng-class=\"{'selected': selection == 2}\">\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"disabled\" ng-hide=\"inputsEnabled\">B</span>\r\n\t\t\t\t\t\t\t\t\t\t<a ng-click=\"onSelection(2)\" ng-show=\"inputsEnabled\" class=\"input-link\" href>B</a>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 1 || selection == 2, 'double-selected': prevPartnerAction == 1 && selection == 2}\">\r\n\t\t\t\t\t\t\t\t\t\t<strong>{{matrix[1][0][0]}}</strong>, <span>{{matrix[1][0][1]}}</span>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t<td ng-class=\"{'selected': prevPartnerAction == 2 || selection == 2, 'double-selected': prevPartnerAction == 2 && selection == 2}\">\r\n\t\t\t\t\t\t\t\t\t\t<strong>{{matrix[1][1][0]}}</strong>, <span>{{matrix[1][1][1]}}</span>\r\n\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\t\t\t<button ng-click=\"confirm()\" ng-disabled=\"!inputsEnabled\" class=\"btn btn-success\">Ready</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-2\"></div>\r\n\t\t\t\t<div class=\"col-lg-5\" style=\"border-left: 1px solid #eee;\">\r\n\t\t\t\t\t<p>Previous Round:</p>\r\n\t\t\t\t\t<table id=\"results-table\" class=\"table table-bordered table-condensed\">\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<th></th>\r\n\t\t\t\t\t\t\t<th>Action</th>\r\n\t\t\t\t\t\t\t<th>Reward</th>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr style=\"font-weight:bold;\">\r\n\t\t\t\t\t\t\t<td>You</td>\r\n\t\t\t\t\t\t\t<td>{{prevAction | action}}</td>\r\n\t\t\t\t\t\t\t<td>{{reward}}</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t<td>Counterpart</td>\r\n\t\t\t\t\t\t\t<td>{{prevPartnerAction | action}}</td>\r\n\t\t\t\t\t\t\t<td>{{partnerReward}}</td>\r\n\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t</table>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div class=\"row\">\r\n\t\t<hr style=\"margin-top:20px;\"/>\r\n\t\t<div class=\"col-lg-12\" id=\"footer\">\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n</body>\r\n{% endverbatim %}\r\n</html>\r\n", "name": "Start", "css": "body {\r\n  padding-top: 60px;\r\n}\r\n\r\n.no-transition:hover{\r\n   -webkit-transition: none;\r\n   background-position: 0 0;\r\n }\r\n \r\n #input-matrix {\r\n   text-align: center;\r\n   vertical-align: middle !important;\r\n }\r\n \r\n #input-matrix > tbody > tr > td {\r\n   text-align: center;\r\n   vertical-align: middle !important;\r\n }\r\n \r\n .input-cell {\r\n   padding: 0 !important;\r\n   width: 80px;\r\n   font-weight:bold;\r\n }\r\n td.selected {\r\n   background-image: url('/static/experiments/discreteMatrix/img/InputShadingLight.png');\r\n }\r\n td.double-selected {\r\n   background-image: url('/static/experiments/discreteMatrix/img/InputShadingDark.png');\r\n }\r\n \r\n.input-link {\r\n  display: block;\r\n}\r\n.disabled {\r\n  color: grey;\r\n}\r\n\r\n#results-table > tbody > tr > th {\r\n  text-align: center;\r\n}", "js": "Redwood.controller(\"SubjectCtrl\", [\"$rootScope\", \"$scope\", \"RedwoodSubject\", function($rootScope, $scope, rs) {\r\n\r\n  rs.on_load(function() {\r\n\t\trs.config.pairs.forEach(function(pair, index) { //decide who is the first player and who is the second player\r\n\t\t\tvar userIndex = pair.indexOf(parseInt(rs.user_id));\r\n\t\t\tif(userIndex > -1) {\r\n\t\t\t\t$scope.pair_index = index;\r\n\t\t\t\t$scope.user_index = userIndex;\r\n\t\t\t\t$scope.partner_id = pair[($scope.user_index + 1) % 2].toString();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$scope.matrix = $scope.user_index === 0 ? rs.config.matrix : transpose(rs.config.matrix);\r\n\r\n\t\t$scope.round = 0;\r\n\r\n\t\trs.synchronizationBarrier('on_load').then(function() {\r\n\t\t\trs.trigger(\"next_round\"); //Start first round\r\n\t\t});\r\n\t});\r\n\r\n\t$scope.onSelection = function(selection) {\r\n\t\tif($scope.inputsEnabled) {\r\n\t\t\t$scope.selection = selection;\r\n\t\t}\r\n\t};\r\n\r\n\t$scope.confirm = function() {\r\n\t\tif(!angular.isNullOrUndefined($scope.selection)) { //Check that user has selected an action\r\n\t\t\t$scope.inputsEnabled = false;\r\n\t\t\trs.trigger(\"action\", $scope.selection);\r\n\t\t} else {\r\n\t\t\talert(\"Please select an action.\");\r\n\t\t}\r\n\t};\r\n\r\n\trs.on(\"action\", function(value) {\r\n\t\t$scope.inputsEnabled = false;\r\n\t\t$scope.selection = value;\r\n\t\t$scope.action = value;\r\n\t\trs.synchronizationBarrier('round_' + $scope.round, [$scope.partner_id]).then(function() { //Call this function once the partner subject has reached this point\r\n\t\t\tallocateRewards($scope.action, $scope.partnerAction);\r\n\t\t\trs.trigger(\"next_round\");\r\n\t\t}, [$scope.partner_id]);\r\n\t});\r\n\r\n\trs.recv(\"action\", function(sender, value) {\r\n\t\tif(sender == $scope.partner_id) {\r\n\t\t\t$scope.partnerAction = value;\r\n\t\t}\r\n\t});\r\n\r\n\trs.on(\"next_round\", function() {\r\n\t\t$scope.round++;\r\n\t\t$scope.rounds = $.isArray(rs.config.rounds) ? rs.config.rounds[$scope.pair_index] : rs.config.rounds;\r\n\r\n\t\t$scope.prevAction = $scope.action;\r\n\t\t$scope.prevPartnerAction = $scope.partnerAction;\r\n\r\n\t\tif($scope.round > $scope.rounds) {\r\n\t\t\trs.next_period(5);\r\n\t\t} else {\r\n\t\t\t$scope.inputsEnabled = true;\r\n\t\t}\r\n\t});\r\n\r\n\tvar allocateRewards = function(ai, aj){\r\n\t\t$scope.reward = $scope.matrix[ai - 1][aj - 1][0];\r\n\t\trs.add_points($scope.reward);\r\n\r\n\t\t$scope.partnerReward = $scope.matrix[ai - 1][aj - 1][1];\r\n\t};\r\n\r\n\tvar transpose = function(matrix) { //transpose a 2x2 matrix\r\n\t\tvar transposed = [[[], []], [[], []]];\r\n\t\tfor(var i = 0; i < 4; i++){\r\n\t\t\tvar row = Math.floor(i/2);\r\n\t\t\tvar column = i % 2;\r\n\t\t\ttransposed[column][row] = [matrix[row][column][1], matrix[row][column][0]];\r\n\t\t}\r\n\t\treturn transposed;\r\n\t};\r\n\r\n}]);\r\n\r\nRedwood.filter(\"action\", function() {\r\n\tvar actions = {\r\n\t\t1: \"A\",\r\n\t\t2: \"B\"\r\n\t};\r\n\treturn function(value) {\r\n\t\treturn\tactions[value];\r\n\t};\r\n});\r\n"}}, {"pk": 67, "model": "expecon.page", "fields": {"experiment": 20, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n<head>\r\n  <title>Finish</title>\r\n\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n  <script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n  <script type=\"text/javascript\">\r\n\t\t{{ js }}\r\n\t</script>\r\n\t<style type=\"text/css\">\r\n\t\t{{ css }}\r\n\t</style>\r\n</head>\r\n{% verbatim %}\r\n<body ng-controller=\"SubjectCtrl\" style=\"padding-top:60px;\">\r\n\t\r\n\t<div class=\"navbar navbar-fixed-top container\">\r\n  <div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t<li class=\"active\">\r\n\t\t\t\t<a>User ID: <span>{{$root.user_id}}</span></a>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t</div>\r\n</div>\r\n\t\r\n\t<div class=\"container\">\r\n\t\t<table class=\"table table-bordered table-condensed\">\r\n\t\t\t<thead>\r\n\t\t\t\t<tr><th>Period</th><th>Points</th><th>Earnings</th></tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody id=\"results\">\r\n\t\t\t  <tr ng-repeat=\"points in pointsByPeriod track by $index\">\r\n          <td>{{$index + 1}}</td><td>{{points | number:2}}</td><td>${{points | number:2}}</td>\r\n        </tr>\r\n        <tr class=\"warning\">\r\n          <td>Average:</td><td>{{$root.totalPoints / ($root.period - 1) | number:2}}</td><td>${{$root.totalPoints / ($root.period - 1) | number:2}}</td>\r\n        </tr>\r\n        <tr class=\"success\">\r\n          <td>Total:</td><td>{{$root.totalPoints | number:2}}</td><td>${{$root.totalPoints | number:2}}</td>\r\n        </tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t</div>\r\n</body>\r\n{% endverbatim %}\r\n</html>\r\n", "name": "Finish", "css": "body {\r\n  padding-top: 60px;\r\n}\r\n\r\n", "js": "Redwood.controller(\"SubjectCtrl\", [\"$rootScope\", \"$scope\", \"RedwoodSubject\", function($rootScope, $scope, rs) {\r\n\r\n  rs.on_load(function() {\r\n\t\t$scope.pointsByPeriod = rs.subject[rs.user_id].points_by_period();\r\n    $scope.pointsByPeriod.shift();\r\n\t});\r\n\r\n}]);"}}]